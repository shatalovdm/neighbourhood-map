"use strict";function getOpenTableData(){restaurantsViewModel.zipSearch()&&$.ajax({url:"http://opentable.herokuapp.com/api/restaurants",method:"GET",data:"zip="+restaurantsViewModel.zipSearch(),dataType:"jsonp",success:function(e){for(var a=0;a<e.restaurants.length;a++){var r,t=e.restaurants[a],s=t.address+", "+t.postal_code;switch(t.price){case 1:r="$";break;case 2:r="$$";break;case 3:r="$$$";break;case 4:r="$$$$";break;default:r=""}restaurantsViewModel.restaurants.push(new Restaurant(t.id,t.name,s,t.lat,t.lng,t.phone,r,t.image_url,t.reserve_url))}populateMap(restaurantsViewModel.restaurants()),$(".restaurant-list").css("display","block")}}).fail(function(){$("caption").html("Could not load the OpenTable data. Try again later.")})}var changed=!1;$(document).ready(function(){ko.applyBindings(restaurantsViewModel)});var Restaurant=function(e,a,r,t,s,i,n,o,l){this.id=e,this.name=a,this.address=r,this.lat=t,this.lng=s,this.phone=i,this.price=n,this.image=o,this.link=l},RestaurantsViewModel=function(){var e=this;e.restaurantId=ko.observable(""),e.restaurants=ko.observableArray(),e.filterName=ko.observable(""),e.filterAddress=ko.observable(""),e.filterPrice=ko.observable("Any"),e.zipSearch=ko.observable("60602"),e.searchZip=function(){5!=e.zipSearch().length||isNaN(e.zipSearch())?$(".search").addClass("has-error"):(e.restaurants().length=0,$("caption").html("Restaurants provided by OpenTable"),getMapData())},e.enableMarker=function(e){for(var a=0;a<markers.length;a++)if(markers[a].id===e.id){highlightMarker(markers[a]);break}},e.disableMarker=function(e){for(var a=0;a<markers.length;a++)if(markers[a].id===e.id){revertMarker(markers[a]);break}},e.filterRestaurants=ko.computed(function(){if(e.filterName()||e.filterAddress()||"Any"!=e.filterPrice()){changed=!0;var a=ko.utils.arrayFilter(e.restaurants(),function(a){return"Any"==e.filterPrice()?-1!==a.name.toLowerCase().indexOf(e.filterName().toLowerCase())&&-1!==a.address.toLowerCase().indexOf(e.filterAddress().toLowerCase()):-1!==a.name.toLowerCase().indexOf(e.filterName().toLowerCase())&&-1!==a.address.toLowerCase().indexOf(e.filterAddress().toLowerCase())&&a.price==e.filterPrice()});return populateMap(a),a}return changed&&populateMap(e.restaurants()),e.restaurants()})},restaurantsViewModel=new RestaurantsViewModel;